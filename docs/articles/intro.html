<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The magick package: Advanced Image-Processing in R • magick</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<link href="../ropensci.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<meta property="og:title" content="The magick package: Advanced Image-Processing in R">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">magick</a>
        <div class="info">
          <span class="partof">part of  <a href="https://ropensci.org"><img src="https://d33wubrfki0l68.cloudfront.net/88338b7637e084df5c43e7a9e6293719dbaf10e2/30903/img/icon_lettering_white.svg" height="24" alt="rOpenSci"></a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">The magick package: Advanced Image-Processing in R</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/ropensci/magick">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>The magick package: Advanced Image-Processing in R</h1>
            
            <h4 class="date">2019-03-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/magick/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<p>The new <a href="https://cran.r-project.org/package=magick">magick</a> package is an ambitious effort to modernize and simplify high-quality image processing in R. It wraps the <a href="https://www.imagemagick.org/Magick++/STL.html">ImageMagick STL</a> which is perhaps the most comprehensive open-source image processing library available today.</p>
<p>The ImageMagick library has an overwhelming amount of functionality. The current version of Magick exposes a decent chunk of it, but being a first release, documentation is still sparse. This post briefly introduces the most important concepts to get started.</p>
<div id="installing-magick" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-magick" class="anchor"></a>Installing <code>magick</code>
</h2>
<p>On Windows or macOS the package is most easily installed via CRAN.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"magick"</span>)</a></code></pre></div>
<p>The binary CRAN packages work out of the box and have most important features enabled. Use <code>magick_config</code> to see which features and formats are supported by your version of ImageMagick.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magick)</a></code></pre></div>
<pre><code>## Linking to ImageMagick 6.9.7.4
## Enabled features: fontconfig, freetype, fftw, lcms, pango, x11
## Disabled features: cairo, ghostscript, rsvg, webp</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(magick<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magick/topics/config">magick_config</a></span>())</a></code></pre></div>
<pre><code>## List of 21
##  $ version           :Class 'numeric_version'  hidden list of 1
##   ..$ : int [1:4] 6 9 7 4
##  $ modules           : logi TRUE
##  $ cairo             : logi FALSE
##  $ fontconfig        : logi TRUE
##  $ freetype          : logi TRUE
##  $ fftw              : logi TRUE
##  $ ghostscript       : logi FALSE
##  $ jpeg              : logi TRUE
##  $ lcms              : logi TRUE
##  $ libopenjp2        : logi FALSE
##  $ lzma              : logi TRUE
##  $ pangocairo        : logi TRUE
##  $ pango             : logi TRUE
##  $ png               : logi TRUE
##  $ rsvg              : logi FALSE
##  $ tiff              : logi TRUE
##  $ webp              : logi FALSE
##  $ wmf               : logi TRUE
##  $ x11               : logi TRUE
##  $ xml               : logi TRUE
##  $ zero-configuration: logi FALSE</code></pre>
<div id="build-from-source" class="section level3">
<h3 class="hasAnchor">
<a href="#build-from-source" class="anchor"></a>Build from source</h3>
<p>On Linux you need to install the ImageMagick++ library: on Debian/Ubuntu this is called <a href="https://packages.debian.org/testing/libmagick++-dev">libmagick++-dev</a>:</p>
<pre><code>sudo apt-get install libmagick++-dev</code></pre>
<p>On Fedora or CentOS/RHEL we need <a href="https://apps.fedoraproject.org/packages/ImageMagick-c++-devel">ImageMagick-c++-devel</a>:</p>
<pre><code>sudo yum install ImageMagick-c++-devel</code></pre>
<p>To install from source on macOS you need <code>imagemagick@6</code> from homebrew.</p>
<pre><code>brew reinstall imagemagick@6 --with-fontconfig --with-librsvg
brew link --force imagemagick@6</code></pre>
<p>The default imagemagick configuration on homebrew disables a bunch of features. It is recommended to brew with at least <code>--with-fontconfig</code> and <code>--with-librsvg</code> to support high quality font / svg rendering (the CRAN OSX binary package enables these as well).</p>
</div>
</div>
<div id="image-io" class="section level2">
<h2 class="hasAnchor">
<a href="#image-io" class="anchor"></a>Image IO</h2>
<p>What makes magick so magical is that it automatically converts and renders all common image formats. ImageMagick supports dozens of formats and automatically detects the type. Use <code><a href="../reference/config.html">magick::magick_config()</a></code> to list the formats that your version of ImageMagick supports.</p>
<div id="read-and-write" class="section level3">
<h3 class="hasAnchor">
<a href="#read-and-write" class="anchor"></a>Read and write</h3>
<p>Images can be read directly from a file path, URL, or raw vector with image data with <code>image_read</code>. The <code>image_info</code> function shows some meta data about the image, similar to the imagemagick <code>identify</code> command line utility.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magick)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">tiger &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read_svg</a></span>(<span class="st">'http://jeroen.github.io/images/tiger.svg'</span>, <span class="dt">width =</span> <span class="dv">400</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(tiger)</a></code></pre></div>
<p>We use <code>image_write</code> to export an image in any format to a file on disk, or in memory if <code>path = NULL</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Render svg to png bitmap</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="../reference/editing.html">image_write</a></span>(tiger, <span class="dt">path =</span> <span class="st">"tiger.png"</span>, <span class="dt">format =</span> <span class="st">"png"</span>)</a></code></pre></div>
<p>If <code>path</code> is a filename, <code>image_write</code> returns <code>path</code> on success such that the result can be piped into function taking a file path.</p>
</div>
<div id="converting-formats" class="section level3">
<h3 class="hasAnchor">
<a href="#converting-formats" class="anchor"></a>Converting formats</h3>
<p>Magick keeps the image in memory in its original format. Specify the <code>format</code> parameter <code>image_write</code> to convert to another format. You can also internally convert the image to another format earlier, before applying transformations. This can be useful if your original format is lossy.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">tiger_png &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_convert</a></span>(tiger, <span class="st">"png"</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="../reference/attributes.html">image_info</a></span>(tiger_png)</a></code></pre></div>
<p>Note that size is currently 0 because ImageMagick is lazy (in the good sense) and does not render until it has to.</p>
</div>
<div id="preview" class="section level3">
<h3 class="hasAnchor">
<a href="#preview" class="anchor"></a>Preview</h3>
<p>IDE’s with a built-in web browser (such as RStudio) automatically display magick images in the viewer. This results in a neat interactive image editing environment.</p>
<img id="rstudioimg" alt="rstudio"><script>
//this is a hack to prevent pandoc 'self_contained' from embedding this image
//in future version of pandoc we can use the image and set 'data-external=1' instead
window.onload = function(){
  document.getElementById("rstudioimg").src = "https://jeroen.github.io/images/magick-rstudio.png";
}
</script><p>Alternatively, on Linux you can use <code>image_display</code> to preview the image in an X11 window. Finally <code>image_browse</code> opens the image in your system’s default application for a given type.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># X11 only</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="../reference/editing.html">image_display</a></span>(tiger)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># System dependent</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw"><a href="../reference/editing.html">image_browse</a></span>(tiger)</a></code></pre></div>
<p>Another method is converting the image to a raster object and plot it on R’s graphics display. However this is very slow and only useful in combination with other plotting functionality. See <a href="#raster-images">#raster</a> below.</p>
</div>
</div>
<div id="transformations" class="section level2">
<h2 class="hasAnchor">
<a href="#transformations" class="anchor"></a>Transformations</h2>
<p>The best way to get a sense of available transformations is walk through the examples in the <code>?transformations</code> help page in RStudio. Below a few examples to get a sense of what is possible.</p>
<div id="cut-and-edit" class="section level3">
<h3 class="hasAnchor">
<a href="#cut-and-edit" class="anchor"></a>Cut and edit</h3>
<p>Several of the transformation functions take an <code>geometry</code> parameter which requires a special syntax of the form <code>AxB+C+D</code> where each element is optional. Some examples:</p>
<ul>
<li>
<code><a href="../reference/transform.html">image_crop(image, "100x150+50")</a></code>: <em>crop out <code>width:100px</code> and <code>height:150px</code> starting <code>+50px</code> from the left</em>
</li>
<li>
<code><a href="../reference/transform.html">image_scale(image, "200")</a></code>: <em>resize proportionally to width: <code>200px</code></em>
</li>
<li>
<code><a href="../reference/transform.html">image_scale(image, "x200")</a></code>: <em>resize proportionally to height: <code>200px</code></em>
</li>
<li>
<code><a href="../reference/painting.html">image_fill(image, "blue", "+100+200")</a></code>: <em>flood fill with blue starting at the point at <code>x:100, y:200</code></em>
</li>
<li>
<code><a href="../reference/composite.html">image_border(frink, "red", "20x10")</a></code>: <em>adds a border of 20px left+right and 10px top+bottom</em>
</li>
</ul>
<p>The full syntax is specified in the <a href="http://www.imagemagick.org/Magick++/Geometry.html">Magick::Geometry</a> documentation.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Example image</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">frink &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"https://jeroen.github.io/images/frink.png"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(frink)</a></code></pre></div>
<pre><code>##   format width height colorspace matte filesize density
## 1    PNG   220    445       sRGB  TRUE    73494   72x72</code></pre>
<p><img src="intro_files/figure-html/unnamed-chunk-6-1.png"><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Add 20px left/right and 10px top/bottom</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="../reference/composite.html">image_border</a></span>(<span class="kw"><a href="../reference/color.html">image_background</a></span>(frink, <span class="st">"hotpink"</span>), <span class="st">"#000080"</span>, <span class="st">"20x10"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-2.png"><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Trim margins</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="../reference/transform.html">image_trim</a></span>(frink)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-3.png"><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Passport pica</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw"><a href="../reference/transform.html">image_crop</a></span>(frink, <span class="st">"100x150+50"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-4.png"><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># Resize</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw"><a href="../reference/transform.html">image_scale</a></span>(frink, <span class="st">"300"</span>) <span class="co"># width: 300px</span></a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-5.png"><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="../reference/transform.html">image_scale</a></span>(frink, <span class="st">"x300"</span>) <span class="co"># height: 300px</span></a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-6.png"><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Rotate or mirror</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw"><a href="../reference/transform.html">image_rotate</a></span>(frink, <span class="dv">45</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-7.png"><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="../reference/transform.html">image_flip</a></span>(frink)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-8.png"><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="../reference/transform.html">image_flop</a></span>(frink)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-9.png"><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># Brightness, Saturation, Hue</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw"><a href="../reference/color.html">image_modulate</a></span>(frink, <span class="dt">brightness =</span> <span class="dv">80</span>, <span class="dt">saturation =</span> <span class="dv">120</span>, <span class="dt">hue =</span> <span class="dv">90</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-10.png"><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># Paint the shirt orange</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw"><a href="../reference/painting.html">image_fill</a></span>(frink, <span class="st">"orange"</span>, <span class="dt">point =</span> <span class="st">"+100+200"</span>, <span class="dt">fuzz =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-11.png"><!-- --></p>
<p>With <code>image_fill</code> we can flood fill starting at pixel <code>point</code>. The <code>fuzz</code> parameter allows for the fill to cross for adjacent pixels with similarish colors. Its value must be between 0 and 256^2 specifying the max geometric distance between colors to be considered equal. Here we give professor frink an orange shirt for the World Cup.</p>
</div>
<div id="filters-and-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#filters-and-effects" class="anchor"></a>Filters and effects</h3>
<p>ImageMagick also has a bunch of standard effects that are worth checking out.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Add randomness</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw"><a href="../reference/effects.html">image_blur</a></span>(frink, <span class="dv">10</span>, <span class="dv">5</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-7-1.png"><!-- --></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw"><a href="../reference/effects.html">image_noise</a></span>(frink)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-7-2.png"><!-- --></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Silly filters</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw"><a href="../reference/effects.html">image_charcoal</a></span>(frink)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-7-3.png"><!-- --></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw"><a href="../reference/effects.html">image_oilpaint</a></span>(frink)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-7-4.png"><!-- --></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw"><a href="../reference/effects.html">image_negate</a></span>(frink)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-7-5.png"><!-- --></p>
</div>
<div id="kernel-convolution" class="section level3">
<h3 class="hasAnchor">
<a href="#kernel-convolution" class="anchor"></a>Kernel convolution</h3>
<p>The <code><a href="../reference/morphology.html">image_convolve()</a></code> function applies a <a href="https://en.wikipedia.org/wiki/Kernel_(image_processing)">kernel</a> over the image. Kernel convolution means that each pixel value is recalculated using the weighted neighborhood sum defined in the kernel matrix. For example lets look at this simple kernel:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">kern &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">kern[<span class="dv">1</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="fl">0.25</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3">kern[<span class="dv">2</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">3</span>)] &lt;-<span class="st"> </span><span class="fl">0.25</span></a>
<a class="sourceLine" id="cb31-4" data-line-number="4">kern[<span class="dv">3</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="fl">0.25</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5">kern</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,] 0.00 0.25 0.00
## [2,] 0.25 0.00 0.25
## [3,] 0.00 0.25 0.00</code></pre>
<p>This kernel changes each pixel to the mean of its horizontal and vertical neighboring pixels, which results in a slight blurring effect in the right-hand image below:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">img &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transform.html">image_resize</a></span>(logo, <span class="st">"300x300"</span>)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">img_blurred &lt;-<span class="st"> </span><span class="kw"><a href="../reference/morphology.html">image_convolve</a></span>(img, kern)</a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="kw"><a href="../reference/animation.html">image_append</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(img, img_blurred))</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-9-1.gif"><!-- --></p>
<p>Or use any of the <a href="http://www.imagemagick.org/Usage/convolve/">standard kernels</a></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">img <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/morphology.html">image_convolve</a></span>(<span class="st">'Sobel'</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/effects.html">image_negate</a></span>()</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-10-1.gif"><!-- --></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">img <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/morphology.html">image_convolve</a></span>(<span class="st">'DoG:0,0,2'</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/effects.html">image_negate</a></span>()</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-10-2.gif"><!-- --></p>
</div>
<div id="text-annotation" class="section level3">
<h3 class="hasAnchor">
<a href="#text-annotation" class="anchor"></a>Text annotation</h3>
<p>Finally it can be useful to print some text on top of images:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># Add some text</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw"><a href="../reference/painting.html">image_annotate</a></span>(frink, <span class="st">"I like R!"</span>, <span class="dt">size =</span> <span class="dv">70</span>, <span class="dt">gravity =</span> <span class="st">"southwest"</span>, <span class="dt">color =</span> <span class="st">"green"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-11-1.png"><!-- --></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># Customize text</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw"><a href="../reference/painting.html">image_annotate</a></span>(frink, <span class="st">"CONFIDENTIAL"</span>, <span class="dt">size =</span> <span class="dv">30</span>, <span class="dt">color =</span> <span class="st">"red"</span>, <span class="dt">boxcolor =</span> <span class="st">"pink"</span>,</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">  <span class="dt">degrees =</span> <span class="dv">60</span>, <span class="dt">location =</span> <span class="st">"+50+100"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-11-2.png"><!-- --></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># Fonts may require ImageMagick has fontconfig</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw"><a href="../reference/painting.html">image_annotate</a></span>(frink, <span class="st">"The quick brown fox"</span>, <span class="dt">font =</span> <span class="st">'Times'</span>, <span class="dt">size =</span> <span class="dv">30</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-11-3.png"><!-- --></p>
<p>Fonts that are supported on most platforms include <code>"sans"</code>, <code>"mono"</code>, <code>"serif"</code>, <code>"Times"</code>, <code>"Helvetica"</code>, <code>"Trebuchet"</code>, <code>"Georgia"</code>, <code>"Palatino"</code>or <code>"Comic Sans"</code>.</p>
</div>
<div id="combining-with-pipes" class="section level3">
<h3 class="hasAnchor">
<a href="#combining-with-pipes" class="anchor"></a>Combining with pipes</h3>
<p>Each of the image transformation functions returns a <strong>modified copy</strong> of the original image. It does not affect the original image.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">frink &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"https://jeroen.github.io/images/frink.png"</span>)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">frink2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transform.html">image_scale</a></span>(frink, <span class="st">"100"</span>)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="kw"><a href="../reference/attributes.html">image_info</a></span>(frink)</a></code></pre></div>
<pre><code>##   format width height colorspace matte filesize density
## 1    PNG   220    445       sRGB  TRUE    73494   72x72</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw"><a href="../reference/attributes.html">image_info</a></span>(frink2)</a></code></pre></div>
<pre><code>##   format width height colorspace matte filesize density
## 1    PNG   100    202       sRGB  TRUE        0   72x72</code></pre>
<p>Hence to combine transformations you need to chain them:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transform.html">image_rotate</a></span>(frink, <span class="dv">90</span>)</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/color.html">image_background</a></span>(test, <span class="st">"blue"</span>, <span class="dt">flatten =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb43-3" data-line-number="3">test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/composite.html">image_border</a></span>(test, <span class="st">"red"</span>, <span class="st">"10x10"</span>)</a>
<a class="sourceLine" id="cb43-4" data-line-number="4">test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/painting.html">image_annotate</a></span>(test, <span class="st">"This is how we combine transformations"</span>, <span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">size =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(test)</a></code></pre></div>
<pre><code>##   format width height colorspace matte filesize density
## 1    PNG   465    240       sRGB  TRUE        0   72x72</code></pre>
<p><img src="intro_files/figure-html/unnamed-chunk-13-1.png"><!-- --></p>
<p>Using <code>magrittr</code> pipe syntax makes it a bit more readable</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"https://jeroen.github.io/images/frink.png"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/transform.html">image_rotate</a></span>(<span class="dv">270</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/color.html">image_background</a></span>(<span class="st">"blue"</span>, <span class="dt">flatten =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/composite.html">image_border</a></span>(<span class="st">"red"</span>, <span class="st">"10x10"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/painting.html">image_annotate</a></span>(<span class="st">"The same thing with pipes"</span>, <span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">size =</span> <span class="dv">30</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-14-1.png"><!-- --></p>
</div>
</div>
<div id="image-vectors" class="section level2">
<h2 class="hasAnchor">
<a href="#image-vectors" class="anchor"></a>Image Vectors</h2>
<p>The examples above concern single images. However all functions in magick have been vectorized to support working with layers, compositions or animation.</p>
<p>The standard base methods <code>[</code> <code>[[</code>, <code><a href="https://www.rdocumentation.org/packages/base/topics/c">c()</a></code> and <code><a href="https://www.rdocumentation.org/packages/base/topics/length">length()</a></code> are used to manipulate vectors of images which can then be treated as layers or frames.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># Download earth gif and make it a bit smaller for vignette</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">earth &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"https://jeroen.github.io/images/earth.gif"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/transform.html">image_scale</a></span>(<span class="st">"200x"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/color.html">image_quantize</a></span>(<span class="dv">128</span>)</a>
<a class="sourceLine" id="cb46-5" data-line-number="5"></a>
<a class="sourceLine" id="cb46-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(earth)</a></code></pre></div>
<pre><code>## [1] 44</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">earth</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-15-1.gif"><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="kw"><a href="../reference/attributes.html">image_info</a></span>(earth))</a></code></pre></div>
<pre><code>##   format width height colorspace matte filesize density
## 1    GIF   200    200       sRGB FALSE        0   72x72
## 2    GIF   200    200       sRGB FALSE        0   72x72
## 3    GIF   200    200       sRGB FALSE        0   72x72
## 4    GIF   200    200       sRGB FALSE        0   72x72
## 5    GIF   200    200       sRGB FALSE        0   72x72
## 6    GIF   200    200       sRGB FALSE        0   72x72</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(earth) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/transform.html">image_flip</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/painting.html">image_annotate</a></span>(<span class="st">"meanwhile in Australia"</span>, <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">color =</span> <span class="st">"white"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-15-2.gif"><!-- --></p>
<div id="layers" class="section level3">
<h3 class="hasAnchor">
<a href="#layers" class="anchor"></a>Layers</h3>
<p>We can stack layers on top of each other as we would in Photoshop:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">bigdata &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">'https://jeroen.github.io/images/bigdata.jpg'</span>)</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">frink &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"https://jeroen.github.io/images/frink.png"</span>)</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">logo &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"https://jeroen.github.io/images/Rlogo.png"</span>)</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">img &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(bigdata, logo, frink)</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">img &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transform.html">image_scale</a></span>(img, <span class="st">"300x300"</span>)</a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="kw"><a href="../reference/attributes.html">image_info</a></span>(img)</a></code></pre></div>
<pre><code>##   format width height colorspace matte filesize density
## 1   JPEG   300    225       sRGB FALSE        0   72x72
## 2    PNG   300    232       sRGB  TRUE        0   72x72
## 3    PNG   148    300       sRGB  TRUE        0   72x72</code></pre>
<p>A mosaic prints images on top of one another, expanding the output canvas such that that everything fits:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw"><a href="../reference/animation.html">image_mosaic</a></span>(img)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-17-1.png"><!-- --></p>
<p>Flattening combines the layers into a single image which has the size of the first image:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw"><a href="../reference/animation.html">image_flatten</a></span>(img)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-18-1.png"><!-- --></p>
<p>Flattening and mosaic allow for specifying alternative <a href="https://www.imagemagick.org/Magick++/Enumerations.html#CompositeOperator">composite operators</a>:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw"><a href="../reference/animation.html">image_flatten</a></span>(img, <span class="st">'Add'</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-19-1.png"><!-- --></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw"><a href="../reference/animation.html">image_flatten</a></span>(img, <span class="st">'Modulate'</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-19-2.png"><!-- --></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw"><a href="../reference/animation.html">image_flatten</a></span>(img, <span class="st">'Minus'</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-19-3.png"><!-- --></p>
</div>
<div id="combining" class="section level3">
<h3 class="hasAnchor">
<a href="#combining" class="anchor"></a>Combining</h3>
<p>Appending means simply putting the frames next to each other:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw"><a href="../reference/animation.html">image_append</a></span>(<span class="kw"><a href="../reference/transform.html">image_scale</a></span>(img, <span class="st">"x200"</span>))</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-20-1.png"><!-- --></p>
<p>Use <code>stack = TRUE</code> to position them on top of each other:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw"><a href="../reference/animation.html">image_append</a></span>(<span class="kw"><a href="../reference/transform.html">image_scale</a></span>(img, <span class="st">"100"</span>), <span class="dt">stack =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-21-1.png"><!-- --></p>
<p>Composing allows for combining two images on a specific position:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">bigdatafrink &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transform.html">image_scale</a></span>(<span class="kw"><a href="../reference/transform.html">image_rotate</a></span>(<span class="kw"><a href="../reference/color.html">image_background</a></span>(frink, <span class="st">"none"</span>), <span class="dv">300</span>), <span class="st">"x200"</span>)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="kw"><a href="../reference/composite.html">image_composite</a></span>(<span class="kw"><a href="../reference/transform.html">image_scale</a></span>(bigdata, <span class="st">"x400"</span>), bigdatafrink, <span class="dt">offset =</span> <span class="st">"+180+100"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-22-1.png"><!-- --></p>
</div>
<div id="pages" class="section level3">
<h3 class="hasAnchor">
<a href="#pages" class="anchor"></a>Pages</h3>
<p>When reading a PDF document, each page becomes an element of the vector. Note that PDF gets rendered while reading so you need to specify the density immediately.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">manual &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read_pdf</a></span>(<span class="st">'https://cloud.r-project.org/web/packages/magick/magick.pdf'</span>, <span class="dt">density =</span> <span class="dv">72</span>)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2"><span class="kw"><a href="../reference/attributes.html">image_info</a></span>(manual)</a>
<a class="sourceLine" id="cb62-3" data-line-number="3">manual[<span class="dv">1</span>]</a></code></pre></div>
</div>
<div id="animation" class="section level3">
<h3 class="hasAnchor">
<a href="#animation" class="anchor"></a>Animation</h3>
<p>Instead of treating vector elements as layers, we can also make them frames in an animation!</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw"><a href="../reference/animation.html">image_animate</a></span>(<span class="kw"><a href="../reference/transform.html">image_scale</a></span>(img, <span class="st">"200x200"</span>), <span class="dt">fps =</span> <span class="dv">1</span>, <span class="dt">dispose =</span> <span class="st">"previous"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-24-1.gif"><!-- --></p>
<p>Morphing creates a sequence of <code>n</code> images that gradually morph one image into another. It makes animations</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">newlogo &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transform.html">image_scale</a></span>(<span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"https://jeroen.github.io/images/Rlogo.png"</span>), <span class="st">"x150"</span>)</a>
<a class="sourceLine" id="cb64-2" data-line-number="2">oldlogo &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transform.html">image_scale</a></span>(<span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"https://developer.r-project.org/Logo/Rlogo-3.png"</span>), <span class="st">"x150"</span>)</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">frames &lt;-<span class="st"> </span><span class="kw"><a href="../reference/animation.html">image_morph</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(oldlogo, newlogo), <span class="dt">frames =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb64-4" data-line-number="4"><span class="kw"><a href="../reference/animation.html">image_animate</a></span>(frames)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-25-1.gif"><!-- --></p>
<p>If you read in an existing GIF or Video file, each frame becomes a layer:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="co"># Foreground image</span></a>
<a class="sourceLine" id="cb65-2" data-line-number="2">banana &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"https://jeroen.github.io/images/banana.gif"</span>)</a>
<a class="sourceLine" id="cb65-3" data-line-number="3">banana &lt;-<span class="st"> </span><span class="kw"><a href="../reference/transform.html">image_scale</a></span>(banana, <span class="st">"150"</span>)</a>
<a class="sourceLine" id="cb65-4" data-line-number="4"><span class="kw"><a href="../reference/attributes.html">image_info</a></span>(banana)</a></code></pre></div>
<pre><code>##   format width height colorspace matte filesize density
## 1    GIF   150    148       sRGB  TRUE        0   72x72
## 2    GIF   150    148       sRGB  TRUE        0   72x72
## 3    GIF   150    148       sRGB  TRUE        0   72x72
## 4    GIF   150    148       sRGB  TRUE        0   72x72
## 5    GIF   150    148       sRGB  TRUE        0   72x72
## 6    GIF   150    148       sRGB  TRUE        0   72x72
## 7    GIF   150    148       sRGB  TRUE        0   72x72
## 8    GIF   150    148       sRGB  TRUE        0   72x72</code></pre>
<p>Manipulate the individual frames and put them back into an animation:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="co"># Background image</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2">background &lt;-<span class="st"> </span><span class="kw"><a href="../reference/color.html">image_background</a></span>(<span class="kw"><a href="../reference/transform.html">image_scale</a></span>(logo, <span class="st">"200"</span>), <span class="st">"white"</span>, <span class="dt">flatten =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb67-3" data-line-number="3"></a>
<a class="sourceLine" id="cb67-4" data-line-number="4"><span class="co"># Combine and flatten frames</span></a>
<a class="sourceLine" id="cb67-5" data-line-number="5">frames &lt;-<span class="st"> </span><span class="kw"><a href="../reference/composite.html">image_composite</a></span>(background, banana, <span class="dt">offset =</span> <span class="st">"+70+30"</span>)</a>
<a class="sourceLine" id="cb67-6" data-line-number="6"></a>
<a class="sourceLine" id="cb67-7" data-line-number="7"><span class="co"># Turn frames into animation</span></a>
<a class="sourceLine" id="cb67-8" data-line-number="8">animation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/animation.html">image_animate</a></span>(frames, <span class="dt">fps =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb67-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(animation)</a></code></pre></div>
<pre><code>##   format width height colorspace matte filesize density
## 1    gif   200    155       sRGB  TRUE        0   72x72
## 2    gif   200    155       sRGB  TRUE        0   72x72
## 3    gif   200    155       sRGB  TRUE        0   72x72
## 4    gif   200    155       sRGB  TRUE        0   72x72
## 5    gif   200    155       sRGB  TRUE        0   72x72
## 6    gif   200    155       sRGB  TRUE        0   72x72
## 7    gif   200    155       sRGB  TRUE        0   72x72
## 8    gif   200    155       sRGB  TRUE        0   72x72</code></pre>
<p><img src="intro_files/figure-html/unnamed-chunk-27-1.gif"><!-- --></p>
<p>Animations can be saved as GIF of MPEG files:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw"><a href="../reference/editing.html">image_write</a></span>(animation, <span class="st">"Rlogo-banana.gif"</span>)</a></code></pre></div>
</div>
</div>
<div id="drawing-and-graphics" class="section level2">
<h2 class="hasAnchor">
<a href="#drawing-and-graphics" class="anchor"></a>Drawing and Graphics</h2>
<p>A relatively recent addition to the package is a native R graphics device which produces a magick image object. This can either be used like a regular device for making plots, or alternatively to open a device which draws onto an existing image using pixel coordinates.</p>
<div id="graphics-device" class="section level3">
<h3 class="hasAnchor">
<a href="#graphics-device" class="anchor"></a>Graphics device</h3>
<p>The <code><a href="../reference/device.html">image_graph()</a></code> function opens a new graphics device similar to e.g. <code><a href="https://www.rdocumentation.org/packages/grDevices/topics/png">png()</a></code> or <code><a href="https://www.rdocumentation.org/packages/grDevices/topics/x11">x11()</a></code>. It returns an image object to which the plot(s) will be written. Each “page” in the plotting device will become a frame in the image object.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="co"># Produce image using graphics device</span></a>
<a class="sourceLine" id="cb70-2" data-line-number="2">fig &lt;-<span class="st"> </span><span class="kw"><a href="../reference/device.html">image_graph</a></span>(<span class="dt">width =</span> <span class="dv">400</span>, <span class="dt">height =</span> <span class="dv">400</span>, <span class="dt">res =</span> <span class="dv">96</span>)</a>
<a class="sourceLine" id="cb70-3" data-line-number="3">ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(mpg, wt, <span class="dt">data =</span> mtcars, <span class="dt">colour =</span> cyl)</a>
<a class="sourceLine" id="cb70-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/dev">dev.off</a></span>()</a></code></pre></div>
<p>We can easily post-process the figure using regular image operations.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="co"># Combine</span></a>
<a class="sourceLine" id="cb71-2" data-line-number="2">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/composite.html">image_composite</a></span>(fig, frink, <span class="dt">offset =</span> <span class="st">"+70+30"</span>)</a>
<a class="sourceLine" id="cb71-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(out)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 7
##   format width height colorspace matte filesize density
##   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
## 1 PNG      400    400 sRGB       TRUE         0 72x72</code></pre>
<p><img src="intro_files/figure-html/unnamed-chunk-29-1.png"><!-- --></p>
</div>
<div id="drawing-device" class="section level3">
<h3 class="hasAnchor">
<a href="#drawing-device" class="anchor"></a>Drawing device</h3>
<p>Another way to use the graphics device is to draw on top of an exiting image using pixel coordinates.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="co"># Or paint over an existing image</span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2">img &lt;-<span class="st"> </span><span class="kw"><a href="../reference/device.html">image_draw</a></span>(frink)</a>
<a class="sourceLine" id="cb73-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/rect">rect</a></span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">200</span>, <span class="dv">100</span>, <span class="dt">border =</span> <span class="st">"red"</span>, <span class="dt">lty =</span> <span class="st">"dashed"</span>, <span class="dt">lwd =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb73-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h =</span> <span class="dv">300</span>, <span class="dt">col =</span> <span class="st">'blue'</span>, <span class="dt">lwd =</span> <span class="st">'10'</span>, <span class="dt">lty =</span> <span class="st">"dotted"</span>)</a>
<a class="sourceLine" id="cb73-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/text">text</a></span>(<span class="dv">30</span>, <span class="dv">250</span>, <span class="st">"Hoiven-Glaven"</span>, <span class="dt">family =</span> <span class="st">"monospace"</span>, <span class="dt">cex =</span> <span class="dv">4</span>, <span class="dt">srt =</span> <span class="dv">90</span>)</a>
<a class="sourceLine" id="cb73-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palette">palette</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">rainbow</a></span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.9</span>))</a>
<a class="sourceLine" id="cb73-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/symbols">symbols</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">200</span>, <span class="dv">11</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">400</span>, <span class="dv">40</span>), <span class="dt">circles =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">11</span>, <span class="dv">5</span>, <span class="dv">35</span>),</a>
<a class="sourceLine" id="cb73-8" data-line-number="8">  <span class="dt">bg =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">11</span>, <span class="dt">inches =</span> <span class="ot">FALSE</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb73-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/dev">dev.off</a></span>()</a></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(img)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 7
##   format width height colorspace matte filesize density
##   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
## 1 PNG      220    445 sRGB       TRUE         0 72x72</code></pre>
<p><img src="intro_files/figure-html/unnamed-chunk-31-1.png"><!-- --></p>
<p>By default <code><a href="../reference/device.html">image_draw()</a></code> sets all margins to 0 and uses graphics coordinates to match image size in pixels (width x height) where (0,0) is the top left corner. Note that this means the y axis increases from top to bottom which is the opposite of typical graphics coordinates. You can override all this by passing custom <code>xlim</code>, <code>ylim</code> or <code>mar</code> values to <code>image_draw</code>.</p>
</div>
<div id="animated-graphics" class="section level3">
<h3 class="hasAnchor">
<a href="#animated-graphics" class="anchor"></a>Animated Graphics</h3>
<p>The graphics device supports multiple frames which makes it easy to create animated graphics. The code below shows how you would implement the example from the very cool <a href="https://github.com/dgrtwo/gganimate">gganimate</a> package using the magick graphics device.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gapminder)</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb76-3" data-line-number="3">img &lt;-<span class="st"> </span><span class="kw"><a href="../reference/device.html">image_graph</a></span>(<span class="dv">600</span>, <span class="dv">340</span>, <span class="dt">res =</span> <span class="dv">96</span>)</a>
<a class="sourceLine" id="cb76-4" data-line-number="4">datalist &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/split">split</a></span>(gapminder, gapminder<span class="op">$</span>year)</a>
<a class="sourceLine" id="cb76-5" data-line-number="5">out &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(datalist, <span class="cf">function</span>(data){</a>
<a class="sourceLine" id="cb76-6" data-line-number="6">  p &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(data, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(gdpPercap, lifeExp, <span class="dt">size =</span> pop, <span class="dt">color =</span> continent)) <span class="op">+</span></a>
<a class="sourceLine" id="cb76-7" data-line-number="7"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size</a></span>(<span class="st">"population"</span>, <span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(gapminder<span class="op">$</span>pop)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="dv">20</span>, <span class="dv">90</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-8" data-line-number="8"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span>(<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(gapminder<span class="op">$</span>gdpPercap)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(data<span class="op">$</span>year) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>()</a>
<a class="sourceLine" id="cb76-9" data-line-number="9">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(p)</a>
<a class="sourceLine" id="cb76-10" data-line-number="10">})</a>
<a class="sourceLine" id="cb76-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/dev">dev.off</a></span>()</a>
<a class="sourceLine" id="cb76-12" data-line-number="12">animation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/animation.html">image_animate</a></span>(img, <span class="dt">fps =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb76-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(animation)</a></code></pre></div>
<pre><code>## # A tibble: 12 x 7
##    format width height colorspace matte filesize density
##    &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
##  1 gif      600    340 sRGB       TRUE         0 72x72  
##  2 gif      600    340 sRGB       TRUE         0 72x72  
##  3 gif      600    340 sRGB       TRUE         0 72x72  
##  4 gif      600    340 sRGB       TRUE         0 72x72  
##  5 gif      600    340 sRGB       TRUE         0 72x72  
##  6 gif      600    340 sRGB       TRUE         0 72x72  
##  7 gif      600    340 sRGB       TRUE         0 72x72  
##  8 gif      600    340 sRGB       TRUE         0 72x72  
##  9 gif      600    340 sRGB       TRUE         0 72x72  
## 10 gif      600    340 sRGB       TRUE         0 72x72  
## 11 gif      600    340 sRGB       TRUE         0 72x72  
## 12 gif      600    340 sRGB       TRUE         0 72x72</code></pre>
<p><img src="intro_files/figure-html/unnamed-chunk-32-1.gif"><!-- --></p>
<p>To write it to a file you would simply do:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw"><a href="../reference/editing.html">image_write</a></span>(animation, <span class="st">"gapminder.gif"</span>)</a></code></pre></div>
</div>
</div>
<div id="raster-images" class="section level2">
<h2 class="hasAnchor">
<a href="#raster-images" class="anchor"></a>Raster Images</h2>
<p>Magick images can also be converted to raster objects for use with R’s graphics device. Thereby we can combine it with other graphics tools. However do note that R’s graphics device is very slow and has a very different coordinate system which reduces the quality of the image.</p>
<div id="base-r-rasters" class="section level3">
<h3 class="hasAnchor">
<a href="#base-r-rasters" class="anchor"></a>Base R rasters</h3>
<p>Base R has an <code>as.raster</code> format which converts the image to a vector of strings. The paper <a href="https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Murrell.pdf">Raster Images in R Graphics</a> by Paul Murrell gives a nice overview.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/as.raster">as.raster</a></span>(frink))</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="co"># Print over another graphic</span></a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(cars)</a>
<a class="sourceLine" id="cb80-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/rasterImage">rasterImage</a></span>(frink, <span class="dv">21</span>, <span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">80</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-34-1.png" width="672"></p>
</div>
<div id="the-grid-package" class="section level3">
<h3 class="hasAnchor">
<a href="#the-grid-package" class="anchor"></a>The <code>grid</code> package</h3>
<p>The <code>grid</code> package makes it easier to overlay a raster on the graphics device without having to adjust for the x/y coordinates of the plot.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(grid)</a>
<a class="sourceLine" id="cb81-3" data-line-number="3"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(speed, dist, <span class="dt">data =</span> cars, <span class="dt">geom =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"point"</span>, <span class="st">"smooth"</span>))</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/grid/topics/grid.raster">grid.raster</a></span>(frink)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-35-1.png" width="480"></p>
</div>
<div id="the-raster-package" class="section level3">
<h3 class="hasAnchor">
<a href="#the-raster-package" class="anchor"></a>The <code>raster</code> package</h3>
<p>The <code>raster</code> package has its own classes for bitmaps which are useful for spatial applications. The simplest way to convert an image to raster is export it as a <code>tiff</code> file:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">tiff_file &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/tempfile">tempfile</a></span>()</a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="kw"><a href="../reference/editing.html">image_write</a></span>(frink, <span class="dt">path =</span> tiff_file, <span class="dt">format =</span> <span class="st">'tiff'</span>)</a>
<a class="sourceLine" id="cb84-3" data-line-number="3">r &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/brick">brick</a></span>(tiff_file)</a>
<a class="sourceLine" id="cb84-4" data-line-number="4">raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plotRGB">plotRGB</a></span>(r)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<p>You can also manually convert the bitmap array into a raster object, but this seems to drop some meta data:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">buf &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(frink[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb85-2" data-line-number="2">rr &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/brick">brick</a></span>(buf)</a>
<a class="sourceLine" id="cb85-3" data-line-number="3">raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plotRGB">plotRGB</a></span>(rr, <span class="dt">asp =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<p>The raster package also does not seem to support transparency, which perhaps makes sense in the context of spatial imaging.</p>
</div>
</div>
<div id="ocr-text-extraction" class="section level2">
<h2 class="hasAnchor">
<a href="#ocr-text-extraction" class="anchor"></a>OCR text extraction</h2>
<p>A recent addition to the package is to extract text from images using OCR. This requires the tesseract package:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"tesseract"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">img &lt;-<span class="st"> </span><span class="kw"><a href="../reference/editing.html">image_read</a></span>(<span class="st">"http://jeroen.github.io/images/testocr.png"</span>)</a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(img)</a>
<a class="sourceLine" id="cb87-3" data-line-number="3"></a>
<a class="sourceLine" id="cb87-4" data-line-number="4"><span class="co"># Extract text</span></a>
<a class="sourceLine" id="cb87-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="kw"><a href="../reference/ocr.html">image_ocr</a></span>(img))</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#installing-magick">Installing <code>magick</code></a><ul class="nav nav-pills nav-stacked">
<li><a href="#build-from-source">Build from source</a></li>
      </ul>
</li>
      <li>
<a href="#image-io">Image IO</a><ul class="nav nav-pills nav-stacked">
<li><a href="#read-and-write">Read and write</a></li>
      <li><a href="#converting-formats">Converting formats</a></li>
      <li><a href="#preview">Preview</a></li>
      </ul>
</li>
      <li>
<a href="#transformations">Transformations</a><ul class="nav nav-pills nav-stacked">
<li><a href="#cut-and-edit">Cut and edit</a></li>
      <li><a href="#filters-and-effects">Filters and effects</a></li>
      <li><a href="#kernel-convolution">Kernel convolution</a></li>
      <li><a href="#text-annotation">Text annotation</a></li>
      <li><a href="#combining-with-pipes">Combining with pipes</a></li>
      </ul>
</li>
      <li>
<a href="#image-vectors">Image Vectors</a><ul class="nav nav-pills nav-stacked">
<li><a href="#layers">Layers</a></li>
      <li><a href="#combining">Combining</a></li>
      <li><a href="#pages">Pages</a></li>
      <li><a href="#animation">Animation</a></li>
      </ul>
</li>
      <li>
<a href="#drawing-and-graphics">Drawing and Graphics</a><ul class="nav nav-pills nav-stacked">
<li><a href="#graphics-device">Graphics device</a></li>
      <li><a href="#drawing-device">Drawing device</a></li>
      <li><a href="#animated-graphics">Animated Graphics</a></li>
      </ul>
</li>
      <li>
<a href="#raster-images">Raster Images</a><ul class="nav nav-pills nav-stacked">
<li><a href="#base-r-rasters">Base R rasters</a></li>
      <li><a href="#the-grid-package">The <code>grid</code> package</a></li>
      <li><a href="#the-raster-package">The <code>raster</code> package</a></li>
      </ul>
</li>
      <li><a href="#ocr-text-extraction">OCR text extraction</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div>
  <p>magick is a part of <img src="https://github.com/ropensci/logos/raw/master/icon_lettering_color.png" height="40" alt="rOpenSci">. Learn more at <a href="https://ropensci.org">ropensci.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by Jeroen Ooms.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>
      </footer>
</div>

  

  </body>
</html>
